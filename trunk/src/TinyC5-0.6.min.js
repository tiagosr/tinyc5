window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(u){return window.setTimeout(u,1E3/60)}}();
function TinyC5(u){var n,l,f,q,g,b,m,e,d,j,k,v=false,o=false,x=0,y,C=1E3/60,h,z,p=false,r=false,s,w,t;s="";w="margin: 0px;padding: 0px;border:none;height: 100%;width: 100%;";w+="position: fixed;left: 0px;top: 0px;right: 0px;bottom: 0px;z-index:10000;";t="";var c=this;this.pixels=null;this.mouseY=this.mouseX=0;this.mouseClick=false;var D=requestAnimFrame,E=cancelRequestAnimFrame,A=function(){v?(c.update(),l.putImageData(g,0,0),m.drawImage(n,0,0,b.width,b.height),c.postUpdate(),c.mouseClick=false,y=
D(A,C)):E(y)},B=function(){j=window.innerWidth/e;k=window.innerHeight/d;this.VIEW_WIDTH=Math.floor(e*j);this.VIEW_HEIGHT=Math.floor(d*k)},F=function(a){for(var c=this.pixels,b=this.pixels.length/4,i=0,a=a||h;b--;)c[i++]=a.r,c[i++]=a.g,c[i++]=a.b,c[i++]=a.a;return this.pixels},G=function(){l.fillRect(0,0,e,d);g=l.getImageData(0,0,e,d);return this.pixels=g.data};this.init=function(a){q&&b&&q.removeChild(b);f=a||{};j=f.scale||1;k=f.scale||1;e=f.width||320;d=f.height||200;o=!f.fullscreen||false;h=f.bgColor||
this.color(0,0,0);q=f.container||document.getElementsByTagName("body")[0];z=f.title||"TinyC5";p=!f.smoothing||false;r=!f.captureMouse||false;n=document.createElement("canvas");n.setAttribute("width",e);n.setAttribute("height",d);l=n.getContext("2d");l.fillStyle="rgba("+h.r+","+h.g+","+h.b+","+h.a+")";g=l.createImageData(e,d);for(var a=0,c=g.data.length;c--;)g.data[a++]=h.r,g.data[a++]=h.g,g.data[a++]=h.b,g.data[a++]=h.a;this.pixels=g.data;this.WIDTH=e;this.HEIGHT=d;this.VIEW_WIDTH=e*j;this.VIEW_HEIGHT=
d*k;b=document.createElement("canvas");b.setAttribute("width",e*j);b.setAttribute("height",d*k);m=b.getContext("2d");q.appendChild(b);this.setSmoothing(f.smoothing);this.setCaptureMouse(f.captureMouse);this.setFullscreen(f.fullscreen);document.title=z};this.start=function(){v=true;x=Date.now();A()};this.stop=function(){v=false};this.onResize=function(){B()};this.setFullscreen=function(a){a!=o&&(a?(o=true,a=document.getElementsByTagName("body")[0],s=a.getAttribute("style"),t=b.getAttribute("style"),
a.setAttribute("style","margin: 0px;padding: 0px;border:none;height: 100%;width: 100%;"),b.setAttribute("style",w),B(),window.addEventListener("resize",this.onResize,false)):(window.removeEventListener("resize",this.onResize,false),o=false,a=document.getElementsByTagName("body")[0],a.setAttribute("style",s),b.setAttribute("style",t),t=s="",j=Math.floor(b.getAttribute("width")/e),k=Math.floor(b.getAttribute("height")/d)))};this.isFullscreen=function(){return o};this.setSmoothing=function(a){if(a!=
p)if(p=a,a=b.style,p){if(m.mozImageSmoothingEnabled)m.mozImageSmoothingEnabled=true;a.setProperty("image-rendering","optimizeQuality","important");a.setProperty("-ms-interpolation-mode","bicubic","important")}else{if(m.mozImageSmoothingEnabled)m.mozImageSmoothingEnabled=false;a.setProperty("image-rendering","optimizeSpeed","important");a.setProperty("image-rendering","-moz-crisp-edges","important");a.setProperty("image-rendering","-webkit-optimize-contrast","important");a.setProperty("image-rendering",
"optimize-contrast","important");a.setProperty("-ms-interpolation-mode","nearest-neighbor","important")}};this.isSmoothing=function(){return p};this.onMouseMove=function(a){var b=a.target,f=c.VIEW_WIDTH,i=c.VIEW_HEIGHT,e=0,d=0,e=a.pageX-b.offsetLeft-b.clientLeft,d=a.pageY-b.offsetTop-b.clientTop,e=~~(e/j),d=~~(d/k),e=f^(e^f)&-(e<f),d=i^(d^i)&-(d<i);c.mouseX=0^(0^e)&-(0<e);c.mouseY=0^(0^d)&-(0<d)};this.onMouseClick=function(){c.mouseClick=true};this.setCaptureMouse=function(a){a!=r&&((r=a)?(b.addEventListener("mousemove",
c.onMouseMove,false),b.addEventListener("click",c.onMouseClick,false)):(b.removeEventListener("mousemove",c.onMouseMove,false),b.removeEventListener("click",c.onMouseClick,false)))};this.isCaptureMouse=function(){return r};this.getCanvas=function(){return b};this.getTime=function(){return Date.now()-x};this.color=function(a,c,b,e){return e?{r:a,g:c,b:b,a:e}:{r:a,g:c,b:b,a:255}};this.copyPixels=function(a){if(this.pixels.length!=a.length)return false;for(var c=a.length,b=0;c--;)this.pixels[b]=a[b++];
return true};this.update=function(){};this.postUpdate=function(){};this.BROWSER_ENGINE_MSIE="msie";this.BROWSER_ENGINE_WEBKIT="webkit";this.BROWSER_ENGINE_SAFARI="safari";this.BROWSER_ENGINE_OPERA="opera";this.BROWSER_ENGINE_MOZILLA="mozilla";this.BROWSER_ENGINE=this.BROWSER_ENGINE_UNKNOWN="unknown";(function(){var a=/(opera)(?:.*version)?[ \/]([\w.]+)/,b=/(msie) ([\w.]+)/,e=/(mozilla)(?:.*? rv:([\w.]+))?/,d=window.navigator.userAgent.toLowerCase();switch((/(webkit)[ \/]([\w.]+)/.exec(d)||a.exec(d)||
b.exec(d)||d.indexOf("compatible")<0&&e.exec(d)||[])[1]){case "mozilla":c.BROWSER_ENGINE=c.BROWSER_ENGINE_MOZILLA;break;case "msie":c.BROWSER_ENGINE=c.BROWSER_ENGINE_MSIE;break;case "webkit":case "safari":c.BROWSER_ENGINE=c.BROWSER_ENGINE_WEBKIT;break;case "opera":c.BROWSER_ENGINE=c.BROWSER_ENGINE_OPERA;break;default:c.BROWSER_ENGINE=c.BROWSER_ENGINE_UNKNOWN}})();this.clearPixels=this.BROWSER_ENGINE===this.BROWSER_ENGINE_MSIE?G:F;this.VERSION=0.6;this.init(u)};