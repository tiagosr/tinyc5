window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(p){return window.setTimeout(p,1E3/60)}}(); function TinyC5(p){var l,j,g,m,e,b,t,h,i,q,r=false,k=false,u=0,v,y=1E3/60,f,w,n,s,o;n="";s="margin: 0px;padding: 0px;border:none;height: 100%;width: 100%;";s+="position: fixed;left: 0px;top: 0px;right: 0px;bottom: 0px;z-index:10000;";o="";var c=this;this.pixels=null;var z=requestAnimFrame,A=cancelRequestAnimFrame,x=function(){r?(c.update(),j.putImageData(e,0,0),t.drawImage(l,0,0,b.width,b.height),v=z(x,y)):A(v)},B=function(a){for(var b=this.pixels,c=this.pixels.length/4,d=0,a=a||f;c--;)b[d++]=a.r, b[d++]=a.g,b[d++]=a.b,b[d++]=a.a;return this.pixels},C=function(){j.fillRect(0,0,h,i);e=j.getImageData(0,0,h,i);return this.pixels=e.data};this.init=function(a){m&&b&&m.removeChild(b);g=a||{};q=g.scale||1;h=g.width||320;i=g.height||200;k=g.fullscreen||false;f=g.bgColor||this.color(0,0,0);m=g.container||document.getElementsByTagName("body")[0];w=g.title||"TinyC5";l=document.createElement("canvas");l.setAttribute("width",h);l.setAttribute("height",i);j=l.getContext("2d");j.fillStyle="rgba("+f.r+","+ f.g+","+f.b+","+f.a+")";e=j.createImageData(h,i);for(var a=0,c=e.data.length;c--;)e.data[a++]=f.r,e.data[a++]=f.g,e.data[a++]=f.b,e.data[a++]=f.a;this.pixels=e.data;this.WIDTH=h;this.HEIGHT=i;b=document.createElement("canvas");b.setAttribute("width",h*q);b.setAttribute("height",i*q);t=b.getContext("2d");m.appendChild(b);this.setFullscreen(k);document.title=w};this.update=function(){};this.start=function(){r=true;u=Date.now();x()};this.stop=function(){r=false};this.setFullscreen=function(a){a!=k&& (a?(k=true,a=document.getElementsByTagName("body")[0],n=a.getAttribute("style"),o=b.getAttribute("style"),a.setAttribute("style","margin: 0px;padding: 0px;border:none;height: 100%;width: 100%;"),b.setAttribute("style",s)):(k=false,a=document.getElementsByTagName("body")[0],a.setAttribute("style",n),b.setAttribute("style",o),o=n=""))};this.isFullscreen=function(){return k};this.getCanvas=function(){return b};this.getTime=function(){return Date.now()-u};this.color=function(a,b,c,d){return d?{r:a,g:b, b:c,a:d}:{r:a,g:b,b:c,a:255}};this.copyPixels=function(a){if(this.pixels.length!=a.length)return false;for(var b=a.length,c=0;b--;)this.pixels[c]=a[c++];return true};this.BROWSER_ENGINE_MSIE="msie";this.BROWSER_ENGINE_WEBKIT="webkit";this.BROWSER_ENGINE_SAFARI="safari";this.BROWSER_ENGINE_OPERA="opera";this.BROWSER_ENGINE_MOZILLA="mozilla";this.BROWSER_ENGINE=this.BROWSER_ENGINE_UNKNOWN="unknown";(function(){var a=/(opera)(?:.*version)?[ \/]([\w.]+)/,b=/(msie) ([\w.]+)/,e=/(mozilla)(?:.*? rv:([\w.]+))?/, d=window.navigator.userAgent.toLowerCase();switch((/(webkit)[ \/]([\w.]+)/.exec(d)||a.exec(d)||b.exec(d)||d.indexOf("compatible")<0&&e.exec(d)||[])[1]){case "mozilla":c.BROWSER_ENGINE=c.BROWSER_ENGINE_MOZILLA;break;case "msie":c.BROWSER_ENGINE=c.BROWSER_ENGINE_MSIE;break;case "webkit":case "safari":c.BROWSER_ENGINE=c.BROWSER_ENGINE_WEBKIT;break;case "opera":c.BROWSER_ENGINE=c.BROWSER_ENGINE_OPERA;break;default:c.BROWSER_ENGINE=c.BROWSER_ENGINE_UNKNOWN}})();this.clearPixels=this.BROWSER_ENGINE===this.BROWSER_ENGINE_MSIE? C:B;this.VERSION=0.5;this.init(p)};